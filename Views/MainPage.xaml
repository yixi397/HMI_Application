<Page x:Class="HMI_Application.Views.MainPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:HMI_Application.Views"
      xmlns:Con="clr-namespace:HMI_Application.Control"
      xmlns:VM="clr-namespace:HMI_Application.ViewModels"
      xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
      mc:Ignorable="d" 
      d:DataContext="{d:DesignInstance Type=VM:MainVM}"
      d:DesignHeight="450" d:DesignWidth="800"
      Title="MainPage">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition></ColumnDefinition>
            <ColumnDefinition Width="auto"></ColumnDefinition>
        </Grid.ColumnDefinitions>


       
        <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="1">
            <StackPanel Orientation="Vertical">

                <!--设备信息显示-->
                <GroupBox Header="设备信息" Margin="3">
                    <StackPanel Orientation="Vertical">
                        <DataGrid ItemsSource="{Binding ListAxisTemplate}" Margin="3"
          CanUserAddRows="False" 
          AutoGenerateColumns="False"
          IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="编号" Binding="{Binding  Number}" Width="50"></DataGridTextColumn>
                                <DataGridTextColumn Header="名称" Binding="{Binding Name}" Width="auto"></DataGridTextColumn>

                                <DataGridTemplateColumn IsReadOnly="True" Header="位置"  Width="80">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding ActPos.Value,StringFormat={}{0:N3}}"></TextBlock>
                                                <TextBlock Text="{Binding Property1}"></TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTemplateColumn IsReadOnly="True" Header="速度"  Width="80">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding ActSpeed.Value,StringFormat={}{0:N3}}"></TextBlock>
                                                <TextBlock Text="{Binding Property2}"></TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="转矩" Binding="{Binding ActTorque.Value,StringFormat={}{0:F2}%}" Width="80"></DataGridTextColumn>

                                <DataGridTemplateColumn IsReadOnly="True" Header="状态"  >
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Con:DeviceStateShow State="{Binding ActState.Value}"  Type="Axis" Margin="0.5" TextAlignment="Center"
                    Width="80"></Con:DeviceStateShow>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTemplateColumn IsReadOnly="True" Header="操作"  Width="auto">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Con:BitButton Width="50" Margin="1" Content="JOG+" Address="{ Binding JogPAddress}" Mode="PressdownON"></Con:BitButton>
                                                <Con:BitButton Width="50" Margin="1" Content="JOG-" Address="{ Binding JogNAddress}" Mode="PressdownON"></Con:BitButton>
                                                <StackPanel Orientation="Horizontal" Width="110">
                                                    <TextBox Width="80" Text="{Binding TarGetPos,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Margin="1"></TextBox>
                                                    <TextBlock Text="{Binding Property1}"></TextBlock>
                                                </StackPanel>
                                                <Button Content="定位运行" Command="{Binding  DataContext.absPositioningCommand,RelativeSource={RelativeSource AncestorType=DataGrid}}"  
                                                        CommandParameter="{Binding}" Margin="1"></Button>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                            </DataGrid.Columns>
                        </DataGrid>

                        <!--其他设备数据-->
                        <DataGrid ItemsSource="{Binding LisOtherDeviceTemplate}" Margin="3"
           CanUserAddRows="False" 
           AutoGenerateColumns="False"
           IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="编号" Binding="{Binding  Number}" Width="50"></DataGridTextColumn>
                                <DataGridTextColumn Header="名称" Binding="{Binding Name}" Width="auto"></DataGridTextColumn>
                                <DataGridTemplateColumn IsReadOnly="True" Header="状态"  >
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Con:DeviceStateShow State="{Binding ActState.Value}" Type="{Binding DeviceType}" Margin="0.5" TextAlignment="Center"
                                          Width="80"></Con:DeviceStateShow>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTemplateColumn IsReadOnly="True" Header="操作"  Width="auto">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Con:BitButton Width="50" Margin="1" Content="{Binding JogPtext}" 
                                        Address="{ Binding JogPAddress}" Mode="PressdownON"></Con:BitButton>
                                                <Con:BitButton Width="50" Margin="1" Content="{Binding JogNtext}" 
                                        Address="{ Binding JogNAddress}" Mode="PressdownON"></Con:BitButton>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                    
                    
                    
                    
                </GroupBox>
               
                
               
                
                <GroupBox Header="状态信息" Margin="3">
                    <DataGrid ItemsSource="{Binding StepShowInfos}"
                              CanUserAddRows="False" 
                              AutoGenerateColumns="False"
                              IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="名称" MinWidth="100" Binding="{ Binding ProcessName}"></DataGridTextColumn>
                            <DataGridTextColumn Header="状态" Width="*" Binding="{ Binding StepName}"></DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
                
            </StackPanel>
        </ScrollViewer>
        
        <!--按钮区域-->
        <ScrollViewer Grid.Column="1"  VerticalScrollBarVisibility="Auto" >
            <StackPanel Orientation="Vertical"   Margin="1" MinWidth="250" >
                <GroupBox  Header="点动按钮" >
                    <StackPanel Orientation="Vertical">
                        <ItemsControl ItemsSource="{Binding ListJogButton}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <UniformGrid Columns="2"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>

                            <ItemsControl.ItemContainerStyle>
                                <Style TargetType="Con:BitButton">
                                    <Setter Property="Margin" Value="2"/>
                                    <Setter Property="FontSize" Value="16"></Setter>
                                   
                                </Style>
                            </ItemsControl.ItemContainerStyle>

                        </ItemsControl>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="功能按钮"  >
                    <StackPanel Orientation="Vertical">
                        <ItemsControl ItemsSource="{Binding ListFunButton}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <UniformGrid Columns="2"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>

                            <ItemsControl.ItemContainerStyle>
                                <Style TargetType="Con:BitButton">
                                    <Setter Property="Margin" Value="1"/>
                                    <Setter Property="FontSize" Value="16"></Setter>
                                </Style>
                            </ItemsControl.ItemContainerStyle>

                            
                        </ItemsControl>
                      
                    </StackPanel>
                </GroupBox>

             


                <ItemsControl ItemsSource="{Binding SpeedInputBoxList}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Vertical"></StackPanel>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding Name}" FontSize="16" Margin="3" VerticalAlignment="Center"></TextBlock>
                                <xctk:IntegerUpDown  FontSize="16"  Minimum="10" Maximum="100" Increment="1" Value="{Binding Value}"/>
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </ScrollViewer>
        

        
        
    </Grid>
</Page>
